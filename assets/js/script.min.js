var programma = [];

function vergaderingNaarArray() {
    if (document.getElementById("subject").value &&
        document.getElementById("startDate").value &&
        document.getElementById("startTime").value &&
        document.getElementById("endTime").value &&
        document.getElementById("description").value
    ) {
        clearVergaderingList();
        programma.push({
            naam: document.getElementById("subject").value,
            startdatum: document.getElementById("startDate").value,
            startuur: document.getElementById("startTime").value,
            einddatum: document.getElementById("endDate").value,
            einduur: document.getElementById("endTime").value,
            beschrijving: document.getElementById("description").value,
            afbeelding: document.getElementById("afbeelding").value
        });
        programma.forEach(function (item) {
            var li = document.createElement('li');
            document.getElementById('vergaderingenList').appendChild(li);
            li.className += "list-group-item";
            li.innerHTML += item.naam;
            li.onclick = function () {
                programma.pop(findVergadering(this));
                this.remove();
            };
        });
        document.getElementById("vergaderingFormulier").reset();
    }
    else {
        alert("Gelieve alle benodigde velden in te vullen.");
    }
}

function clearVergaderingList() {
    while (document.getElementById('vergaderingenList').firstChild) {
        document.getElementById('vergaderingenList').removeChild(document.getElementById('vergaderingenList').firstChild);
    }

}

function findVergadering(title) {
    for (var key in programma) {
        if (programma[key].naam == title) return key;
    }
    return false;
}


function downloadCSV() {
    var data = "data:text/json;charset=utf-8," + encodeURIComponent(toYML());
    var link = document.createElement('a');
    link.setAttribute('href', data);
    link.setAttribute('download', "programma.yml");
    link.click();
}


function toYML(){
    let yml="";
    programma.forEach(element => {
        let data = `- naam: ${element.naam}\n  startdatum: ${element.startdatum}\n  startuur: ${element.startuur}\n  einddatum: ${element.einddatum}\n  afbeelding: ${element.afbeelding}\n  einduur: ${element.einduur}\n  beschrijving: ${element.beschrijving}\n`;
        yml = yml.concat(data);
    });
    return yml;
}